{% load blog_tags %}{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}MyBlog{% endblock %}</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- AOS (Animate On Scroll) -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">

  <!-- App CSS -->
  <link href="{% static 'css/blog.css' %}" rel="stylesheet">
</head>
<body>
  <!-- HEADER -->
    <header id="main-header">
        <div class="header-left">
            <span id="logo">MyBlog</span>
        </div>

        <div class="header-center">
            <form method="get" action="{% url 'blog:post_list' %}" class="search-form">
                <input type="text" name="query" placeholder="Search posts..." 
                    value="{{ request.GET.query|default:'' }}">
                <button type="submit"><i class="fas fa-search"></i></button>
            </form>
        </div>

        <div class="header-right">
            <!-- Dark Mode Toggle -->
            <button id="theme-toggle" class="theme-btn">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </header>


  <!-- Main Layout -->
  <div class="layout container">
    <main id="content">
      {% block content %}{% endblock %}
    </main>

    <!-- Sidebar -->
    <aside id="sidebar">
      <div class="sidebar-card about" data-aos="fade-left">
        <h2><i class="fas fa-info-circle"></i> About</h2>
        <p>This is my blog. I've written {% total_posts %} posts so far.</p>
        <a href="{% url 'blog:post_feed' %}" class="rss-link">
          <i class="fas fa-rss"></i> Subscribe to my RSS feed
        </a>
      </div>

      <div class="sidebar-card latest-posts" data-aos="fade-left" data-aos-delay="100">
        <h3><i class="fas fa-clock"></i> Latest posts</h3>
        {% show_latest_posts 5 %}
      </div>

      <div class="sidebar-card most-commented" data-aos="fade-left" data-aos-delay="200">
        <h3><i class="fas fa-fire"></i> Most commented</h3>
        {% get_most_commented_post as most_commented_posts %}
        <ul>
          {% for post in most_commented_posts %}
            <li><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></li>
          {% endfor %}
        </ul>
      </div>
    </aside>
  </div>

  <!-- Footer -->
  <footer id="footer">
    <p>&copy; {% now "Y" %} MyBlog â€” Built with Django.</p>
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script src="{% static 'js/blog.js' %}"></script>
  <script>AOS.init({ once: true, duration: 500, easing: 'ease-out' });</script>
</body>
</html>
