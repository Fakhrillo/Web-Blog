{% extends "blog/base.html" %}
{% load blog_tags %}
{% block title %}
  {% if query %}Search: {{ query }}{% elif tag %}Posts tagged "{{ tag.name }}"{% else %}Latest Posts{% endif %}
{% endblock %}

{% block content %}
  <h1 class="page-title" data-aos="fade-up">
    {% if query %}Search results for “{{ query }}”
    {% elif tag %}Posts tagged “{{ tag.name }}”
    {% else %}Latest Posts
    {% endif %}
  </h1>

  <section class="post-list">
    {% for post in posts %}
      <article class="post-card" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:'0' }}00">
        <div class="post-meta">
          <span class="date">Published {{ post.publish|date:"F j, Y" }}</span>
          <span class="sep">·</span>
          <span class="author">{{ post.author }}</span>
        </div>

        <h2 class="post-title"><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>

        {% if post.tags.all %}
          <div class="tags">
            {% for tag in post.tags.all %}
              <a class="tag" href="{% url 'blog:post_list_by_tag' tag.slug %}">{{ tag.name }}</a>
            {% endfor %}
          </div>
        {% endif %}

        <div class="excerpt">
          {{ post.content|markdown|truncatewords_html:36 }}
        </div>

        <a href="{{ post.get_absolute_url }}" class="read-more">Read More <i class="fa fa-arrow-right"></i></a>
      </article>
    {% empty %}
      <p class="muted">No posts found.</p>
    {% endfor %}
  </section>

  {% include "blog/pagination.html" with page=posts query=query %}
{% endblock %}
