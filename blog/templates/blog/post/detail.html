{% extends "blog/base.html" %}
{% load blog_tags %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<article class="post-detail" data-aos="fade-up">
  <header class="post-header">
    <h1>{{ post.title }}</h1>
    <div class="post-meta">
      <span class="date">Published {{ post.publish|date:"F j, Y" }}</span>
      <span class="sep">·</span>
      <span class="author">{{ post.author }}</span>
    </div>
    {% if post.tags.all %}
      <div class="tags">
        {% for tag in post.tags.all %}
          <a class="tag" href="{% url 'blog:post_list_by_tag' tag.slug %}">{{ tag.name }}</a>
        {% endfor %}
      </div>
    {% endif %}
  </header>

  <div class="post-body-wrapper">
    <section class="post-content">
      {{ post.content|markdown }}
    </section>
  </div>

  <footer class="post-footer">
    <a href="{% url 'blog:post_share' post.id %}" class="btn-share">
      <i class="fas fa-share-alt"></i> Share this post
    </a>
  </footer>
</article>

<section class="similar-posts" data-aos="fade-up" data-aos-delay="100">
  <h2>Similar Posts</h2>
  <div class="similar-grid">
    {% for post in similar_posts %}
      <a class="similar-card" href="{{ post.get_absolute_url }}">{{ post.title }}</a>
    {% empty %}
      <p class="muted">No similar posts yet.</p>
    {% endfor %}
  </div>
</section>

<section class="comments-section" data-aos="fade-up" data-aos-delay="150">
  {% with comments.count as total_comments %}
    <h2>{{ total_comments }} Comment{{ total_comments|pluralize }}</h2>
  {% endwith %}

  {% for comment in comments %}
    <div class="comment-card">
      <p class="comment-meta"><strong>{{ comment.name }}</strong> · {{ comment.created|date:"F j, Y" }}</p>
      <div class="comment-body">{{ comment.content|linebreaks }}</div>
    </div>
  {% empty %}
    <p class="muted">No comments yet.</p>
  {% endfor %}
</section>

<section class="comment-form-section" data-aos="fade-up" data-aos-delay="200">
  <h3>Leave a Comment</h3>
  {% include "blog/post/includes/comment_form.html" %}
</section>
{% endblock %}
